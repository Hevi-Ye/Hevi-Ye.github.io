---
title:  "矿工是如何打包交易记录再上主链的"
tags: 比特币 区块链
---

人们在用比特币作交易时产生的交易记录是如何被矿工打包的？矿工为什么要帮你打包你的交易记录？对他有什么好处？怎么保证他打包的记录都是真实有效的？这是我们要了解的问题：

## 挖矿流程

1. 假如A用户转10个比特币给用户B，并广播出去

    A -> B (10BTC)

2. 这里所有矿工都收到这条记录，矿工们将这条记录收录到他的电脑本地，和其他记录一起打包成一个区块，比如是这个的区块

```
-----------------
| 区块头         |
|---------------|
| A -> B (10BTC)|
| A -> B (交易费)|
| C -> D (1BTC) |
| C -> D (交易费)|
| E -> F (11BTC)|
| E -> F (交易费)|
| G -> H (20BTC)|
| G -> H (交易费)|
-----------------
```

3. 区块头里包含了前一个区块的hash值，当前交易记录的merkle tree的根hash值，区块链版本，nonce，难度值，时间戳等信息，这里矿工就必须根据区块头和不断变换nonce值来计算符合难度要求的hash值，比如这个难度要求是计算出来的这个hash值前面必须是9个0
4. 如果有矿工计算出这个nonce值并符合难度要求，就说他挖到矿了，这时他就要把这个区块广播给其他矿工，告诉他们我挖到矿了
5. 其他矿工必须验证他的这个区块是不是合法的，包括是否符合难度要求，每个交易是否合法（没有假的交易）
6. 其他矿工都验证通过了，那么其他矿工就会把这个区块加入到他们自己本地区块链的后面，成为主链，然后在这个主链后面再继续挖矿

## 为什么要帮你打包记录，对矿工有什么好处

对矿工来说，挖到矿有两种收益：
* 区块奖励

矿工挖到区块后，区块链系统会奖励一个数量的比特币，这是主要的收益

* 用户的交易时的交易手续费
  
每个用户发起一笔交易，必须上缴一定的手续费，做为矿工打包的辛苦费


