---
layout: post
title:  "编译器做了什么"
date:   2018-07-19 23:06:54
categories: build
tags: 编译
---

* content
{:toc}

编译器是干什么用的？为什么程序运行前需要编译？编译后又变成什么了？编译过程发生了什么？




**问：** 编译器是什么？  
**答：** 编译器是一个工具，可以将高级语言翻译成机器语言

**问：** 什么是高级语言？什么是机器语言？  
**答：** 高级语言如果C、C++、Java、C#、Go等语言，机器语言就是一堆二进制指令，只有机器才有识别

**问：** 为什么需要编译？  
**答：** 计算机无法识别高级语言，只能把高级语言转换成机器能够识别的语言，这样程序才可以运行

**问：** 编译了变成什么东西了？  
**答：** 编译后就成了可执行文件，这时就可以直接运行这个程序

**问：** 什么是可执行文件，它是怎么生成的？  
**答：** 像Windows里的.exe文件，和Linux的/bin/下文件都是可执行文件。它是由多个目标文件通过链接器拼装起来的

**问：** 什么是目标文件？  
**答：** 目标文件是编译器编译过程中还没有进行链接时生成的文件（Windows是.obj文件，Linux是.o文件）

**问：** 怎么生成目标文件的？  
**答：** 需要编译器进行如下步骤才可生成目标文件：
* 词法分析
    * 运用某种算法把代码的字符序列分割成一系列的记号（Token）
* 语法分析
    * 生成以表达式为节点的语法树
* 语义分析
    * 分析语法树的类型及类型转换
* 中间语言生成
    * 将语法树转换成中间代码（如：三地址码），然后将该优化的地方优化掉
* 目标代码生成与优化
    * 将中间代码转换成目标机器代码

上面一堆事情做完之后就生成了一个目标文件（.o文件）它是二进制的指令集

**问：** 怎么将目标文件变成执行文件怎么生成的？  
**答：** 链接器将多个目标文件拼装在一起，就变成了可执行文件

> 可以使用`gcc`工具来生成目标文件或可执行文件
```bash
// 生成目标文件
$ gcc -c test.c -o test.o
```
```bash
// 直接生成可执行文件
$ gcc test.c
```
